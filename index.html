
<!DOCTYPE html><html lang="pt-BR"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Rendimento Analyzer</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.15.0/dist/themes/light.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <style>:root{--win:#fff;--border:#d1d1d6;--bg:linear-gradient(120deg,#e5e9f2 0%,#f9f9fb 100%);--text:#1c1c1e;--muted:#6e6e73;--accent:#0a84ff;--pos:#34c759;--neg:#ff3b30;--radius:12px;--shadow:0 2px 8px rgba(0,0,0,.12);}html[data-theme="dark"]{--win:#1c1c1e;--border:#3a3a3c;--bg:#1c1c1e;--text:#f2f2f7;--muted:#8e8e93;--shadow:0 2px 8px rgba(0,0,0,.5);}*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,'SF Pro',Inter,Segoe UI,Arial,sans-serif}body{margin:0;background:var(--bg);color:var(--text);display:flex;align-items:center;justify-content:center;min-height:100vh}main{width:95%;max-width:1450px;background:var(--win);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}header{display:flex;align-items:center;padding:10px 14px;border-bottom:1px solid var(--border)}.traffic{display:flex;gap:6px;margin-right:10px}.dot{width:12px;height:12px;border-radius:50%}.red{background:#ff5f57}.yellow{background:#ffbd2e}.green{background:#28c840}h1{font-size:15px;font-weight:600;margin:0;color:var(--muted)}#toolbar{display:flex;flex-wrap:wrap;gap:8px;padding:12px 16px;border-bottom:1px solid var(--border)}button{appearance:none;background:var(--win);color:var(--text);padding:6px 14px;border:1px solid var(--border);border-radius:8px;font-size:14px;cursor:pointer;transition:.15s}button:hover{background:rgba(0,0,0,.05)}button.active{background:var(--accent);color:#fff;border-color:var(--accent)}button.icon{padding:6px}button.icon svg{width:18px;height:18px;fill:currentColor}#controls{display:flex;gap:10px;flex-wrap:wrap;padding:14px 16px;border-bottom:1px solid var(--border)}select,input[type=date]{padding:6px 10px;border:1px solid var(--border);border-radius:6px;font-size:14px;background:var(--win);color:var(--text)}#status{padding:12px 16px;font-size:13px;color:var(--muted)}#info{padding:16px 16px;font-size:14px;border-bottom:1px solid var(--border)}#tableWrap{overflow-x:auto;padding:0 16px}table{width:100%;border-collapse:collapse;margin-top:14px;font-size:13px}th,td{border:1px solid var(--border);padding:6px 10px}th{background:var(--win);text-align:left}td.num,th.num{text-align:right}.pos{color:var(--pos);font-weight:600}.neg{color:var(--neg);font-weight:600}.na{color:var(--muted)}#charts{padding:20px 16px;display:flex;flex-direction:column;gap:26px}.cBox{border:1px solid var(--border);border-radius:var(--radius);padding:10px;background:var(--win)}canvas{max-height:48vh}footer{display:flex;justify-content:center;padding:12px 16px;font-size:12px;color:var(--muted)}.hidden{display:none!important}</style></head><body><main><header><div class="traffic"><div class="dot red"></div><div class="dot yellow"></div><div class="dot green"></div></div><h1>Rendimento Analyzer</h1></header><div id="toolbar"><button id="bDia" class="active">Dia</button><button id="bDias">Dias (2)</button><button id="bMes">Mês</button><button id="bMeses">Meses (2)</button><button id="bAno">Ano × Ano</button><button id="bTurno" class="icon" title="Turno"><svg viewBox="0 0 24 24"><circle cx="8" cy="8" r="3"/><circle cx="16" cy="16" r="3"/><path d="M13 6l5 5M6 13l5 5" stroke="currentColor" stroke-width="2" fill="none"/></svg></button><button id="bTheme" class="icon" title="Tema"><svg viewBox="0 0 24 24"><path d="M12 3v18M3 12h18" stroke="currentColor" stroke-width="2" fill="none"/></svg></button><button id="bExport" class="icon" title="PDF"><svg viewBox="0 0 24 24"><path d="M6 2h9l5 5v15a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z" fill="none" stroke="currentColor" stroke-width="2"/><path d="M14 2v6h6" fill="none" stroke="currentColor" stroke-width="2"/></svg></button></div><div id="controls"></div><div id="status"></div><div id="info" class="hidden"></div><div id="tableWrap"></div><div id="charts" class="hidden"><div class="cBox"><canvas id="chartProdutos"></canvas></div><div class="cBox hidden" id="chartIndustrialBox"><canvas id="chartIndustrial"></canvas></div></div><footer>© 2025 Adriano Tools</footer></main><script>const META=81.600;let files=[],turno='turno1',mode='Dia';const $=s=>document.querySelector(s);const $$=s=>[...document.querySelectorAll(s)];const removeAccents=s=>s.normalize('NFD').replace(/[̀-ͯ]/g,'');const loadManifest=async()=>{try{$('#status').textContent='⏳ Manifest...';const r=await fetch('index.json');const j=await r.json();files=j.arquivos||[];$('#status').textContent='';initUI();}catch(e){$('#status').textContent='Erro index.json';console.error(e);}};loadManifest();function initUI(){toolbarEvents();renderControls();}function toolbarEvents(){['bDia','bDias','bMes','bMeses','bAno'].forEach(id=>$('#'+id).onclick=()=>{mode=id.slice(1);$$('#toolbar button').forEach(b=>b.classList.remove('active'));$('#'+id).classList.add('active');renderControls();});$('#bTurno').onclick=()=>{turno=turno==='turno1'?'turno2':'turno1';renderControls();};$('#bTheme').onclick=()=>{document.documentElement.dataset.theme=document.documentElement.dataset.theme==='dark'?'light':'dark';};$('#bExport').onclick=()=>html2pdf().from(document.querySelector('main')).set({margin:.4,filename:'rendimento.pdf',image:{type:'jpeg',quality:.96},html2canvas:{scale:2},jsPDF:{unit:'in',format:'a4',orientation:'landscape'}}).save();}function renderControls(){const c=$('#controls');c.innerHTML='';const sel1=createSelect('sel1');const sel2=createSelect('sel2');const btn=document.createElement('button');btn.textContent='Carregar';btn.className='active';if(mode==='Dia'){c.append(sel1,btn);populateSelect(sel1,'dia');btn.onclick=()=>process([sel1.value],[$(sel1).selectedOptions[0].text],false);}else if(mode==='Dias'){c.append(sel1,sel2,btn);populateSelect(sel1,'dia');populateSelect(sel2,'dia');btn.onclick=()=>process([sel1.value,sel2.value],[$(sel1).selectedOptions[0].text,$(sel2).selectedOptions[0].text],false);}else if(mode==='Mês'){c.append(sel1,btn);populateSelect(sel1,'mes');btn.onclick=()=>process([sel1.value],[$(sel1).selectedOptions[0].text],true);}else if(mode==='Meses'){c.append(sel1,sel2,btn);populateSelect(sel1,'mes');populateSelect(sel2,'mes');btn.onclick=()=>process([sel1.value,sel2.value],[$(sel1).selectedOptions[0].text,$(sel2).selectedOptions[0].text],true);}else if(mode==='Ano'){c.append(sel1,sel2,btn);populateSelect(sel1,'mesAno');populateSelect(sel2,'mesAno');btn.onclick=()=>process([sel1.value,sel2.value],[$(sel1).selectedOptions[0].text,$(sel2).selectedOptions[0].text],true);}function createSelect(id){const s=document.createElement('select');s.id=id;return s;}function populateSelect(sel,tipo){const opts=['<option value="">Selecione...</option>'];if(tipo==='dia'){files.filter(f=>f.endsWith(turno+'.json')&&f.match(/^.+\.(\d{2})\.(\d{2})\.(\d{2})\./)).forEach(f=>opts.push(`<option value="${f}">${f.replace('.json','')}</option>`));}else if(tipo==='mes'){files.filter(f=>f.startsWith('mensal')&&f.endsWith(turno+'.json')).forEach(f=>opts.push(`<option value="${f}">${f.replace('.json','')}</option>`));}else if(tipo==='mesAno'){files.filter(f=>f.match(/^mensal\.\d{2}\.\d{2}\./)||f.match(/^(janeiro|fevereiro|marco|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)\.\d{4}\.json/i)).forEach(f=>opts.push(`<option value="${f}">${f.replace('.json','')}</option>`));}sel.innerHTML=opts.join('');}}let chartP,chartI;function clearAll(){if(chartP){chartP.destroy();chartP=null;}if(chartI){chartI.destroy();chartI=null;$('#chartIndustrialBox').classList.add('hidden');}$('#tableWrap').innerHTML='';$('#charts').classList.add('hidden');$('#info').classList.add('hidden');}async function process(fileKeys,labels,isMensal){try{if(fileKeys.some(f=>!f)){alert('Seleção incompleta');return;}$('#status').textContent='⌛ Dados...';clearAll();const dados=await Promise.all(fileKeys.map(async key=>{const match=files.find(f=>removeAccents(f)===removeAccents(key));if(!match)throw`Arquivo não encontrado: ${key}`;const r=await fetch(match);if(!r.ok)throw'HTTP '+r.status;return r.json();}));$('#info').classList.remove('hidden');$('#info').textContent=labels.join(' × ');const produtos=[...new Set(dados.flatMap(d=>d.itens.map(i=>i.produto)))];let html='<table><thead><tr><th>Produto</th>';if(dados.length===1){html+='<th class="num">Meta %</th><th class="num">Realizado %</th><th class="num">Dif %</th><th class="num">Kg</th><th class="num">Cx</th></tr></thead><tbody>';}else{html+=`<th class="num">${labels[0]} %</th><th class="num">${labels[1]} %</th><th class="num">Dif %</th><th class="num">Dif Kg</th><th class="num">Dif Cx</th></tr></thead><tbody>`;}const metas=[],v1=[],v2=[];produtos.forEach(p=>{const d1=dados[0].itens.find(i=>i.produto===p)||{};const d2=dados[1]?dados[1].itens.find(i=>i.produto===p)||{}:{};const meta=d1.meta||d2.meta||0;const r1=+d1.realizado||0;const r2=dados.length>1?(+d2.realizado||0):0;metas.push(meta);v1.push(r1);if(dados.length>1)v2.push(r2);html+='<tr><td>'+p+'</td>';if(dados.length===1){const diff=r1-meta;const cls=diff>0?'pos':diff<0?'neg':'na';html+=`<td class="num">${meta.toFixed(3)}%</td><td class="num">${r1.toFixed(3)}%</td><td class="num ${cls}">${diff.toFixed(3)}%</td><td class="num">${(+d1.quilos||0).toFixed(2)}</td><td class="num">${Math.round(+d1.caixas||0)}</td>`;}else{const diff=r2-r1;const cls=diff>0?'pos':diff<0?'neg':'na';html+=`<td class="num">${r1.toFixed(3)}%</td><td class="num">${r2.toFixed(3)}%</td><td class="num ${cls}">${diff.toFixed(3)}%</td><td class="num ${cls}">${((+d2.quilos||0)-(+d1.quilos||0)).toFixed(2)}</td><td class="num ${cls}">${(Math.round(+d2.caixas||0)-Math.round(+d1.caixas||0))}</td>`;}html+='</tr>';});html+='</tbody></table>';$('#tableWrap').innerHTML=html;// chartsconst ctx=$('#chartProdutos').getContext('2d');const ds=[{label:'Meta %',data:metas,backgroundColor:'rgba(255,159,64,.6)'},{label:labels[0],data:v1,backgroundColor:'rgba(0,122,255,.6)'}];if(dados.length>1)ds.push({label:labels[1],data:v2,backgroundColor:'rgba(48,209,88,.6)'});chartP=new Chart(ctx,{type:'bar',data:{labels:produtos,datasets:ds},options:{plugins:{legend:{position:'top'},title:{display:true,text:'Meta × Realizado'}}}});if(isMensal){$('#chartIndustrialBox').classList.remove('hidden');const ctx2=$('#chartIndustrial').getContext('2d');const ind=[META].concat(dados.map(d=>d.rendimentoIndustrial||0));chartI=new Chart(ctx2,{type:'bar',data:{labels:['Meta'].concat(labels),datasets:[{data:ind,backgroundColor:['#ff9f0a','#0a84ff','#32d74b']}]},options:{plugins:{legend:{display:false},title:{display:true,text:'Rendimento Industrial'}}}});}$('#charts').classList.remove('hidden');$('#status').textContent='';}catch(e){$('#status').textContent='❌ '+e;console.error(e);} }</script></body></html>
